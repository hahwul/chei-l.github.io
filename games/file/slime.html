<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì´ˆëŒ€í˜• ì…ì²´ ìŠ¬ë¼ì„ í‚¤ìš°ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #fff0f5;
            overflow: hidden;
            touch-action: none;
            font-family: 'Nanum Gothic', sans-serif;
            user-select: none;
            transition: background 0.5s ease;
        }
        #game-screen {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        #slime-container {
            flex-grow: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            perspective: 1000px;
        }
        .slime {
            width: 250px;
            height: 250px;
            border-radius: 50%;
            filter: blur(1px);
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275), border-radius 0.3s ease;
            cursor: pointer;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 8px solid rgba(255,255,255,0.5);
            z-index: 50;
            box-shadow:
                inset 25px 25px 50px rgba(255, 255, 255, 0.7),
                inset -25px -25px 60px rgba(0,0,0,0.15),
                0 50px 80px rgba(0,0,0,0.2);
            animation: idle-float 4s ease-in-out infinite;
        }

        @keyframes idle-float {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.02); }
        }

        .face {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            pointer-events: none;
            z-index: 100;
        }

        .eyes {
            display: flex;
            gap: 40px;
        }
        .eye {
            width: 25px;
            height: 35px;
            background: #333;
            border-radius: 50%;
            position: relative;
            animation: blink 4s infinite;
        }
        .eye::after {
            content: '';
            position: absolute;
            top: 5px;
            left: 5px;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
        }
        @keyframes blink {
            0%, 90%, 100% { transform: scaleY(1); }
            95% { transform: scaleY(0.1); }
        }

        .mouth {
            width: 30px;
            height: 15px;
            border: 3px solid #333;
            border-top: 0;
            border-radius: 0 0 15px 15px;
            transition: all 0.3s ease;
        }
        .mouth.happy {
            width: 40px;
            height: 20px;
            border-radius: 0 0 20px 20px;
            border: 4px solid #333;
            border-top: 0;
        }
        .mouth.eating {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #333;
            transform: scale(1.2);
        }
        .mouth.sleeping {
            width: 20px;
            height: 5px;
            border-radius: 5px;
            background: #333;
            border: none;
        }
        .mouth.sick {
            width: 30px;
            height: 5px;
            border-radius: 50% 50% 0 0;
            border: 3px solid #333;
            border-bottom: 0;
        }

        /* Animations */
        .slime.slide-anim { animation: slide-action 1.5s ease-in-out forwards; }
        @keyframes slide-action {
            0% { transform: translate(150px, -150px) rotate(-20deg); }
            100% { transform: translate(-150px, 150px) rotate(-20deg); }
        }
        .slime.seesaw-anim { animation: seesaw-action 2s ease-in-out infinite; }
        @keyframes seesaw-action {
            0%, 100% { transform: translate(-100px, 20px); }
            50% { transform: translate(-100px, -50px); }
        }
        .slime.swing-anim { animation: swing-action 2s ease-in-out infinite; transform-origin: top center; }
        @keyframes swing-action {
            0%, 100% { transform: rotate(-15deg) translateY(50px); }
            50% { transform: rotate(15deg) translateY(50px); }
        }
        .slime.wash-anim { animation: wash-action 1s ease-in-out infinite; }
        @keyframes wash-action {
            0%, 100% { transform: rotate(-5deg) scale(1.05); }
            50% { transform: rotate(5deg) scale(0.95); }
        }

        .playground-obj {
            position: absolute;
            pointer-events: none;
            z-index: 10;
            opacity: 0.8;
            transition: all 0.5s;
        }
        .slide-obj { font-size: 150px; transform: translate(50px, 50px); }
        .seesaw-obj { font-size: 120px; transform: translate(-50px, 100px); }
        .swing-obj { font-size: 130px; transform: translate(0, -100px); }
        .kitchen-obj { font-size: 150px; transform: translateY(80px); }
        .hospital-obj { font-size: 120px; transform: translateY(-120px); opacity: 0.5; }
        .bath-obj { font-size: 200px; transform: translateY(100px); }
        .garden-obj { font-size: 180px; transform: translateY(50px); z-index: 1; }

        .highlight {
            position: absolute;
            top: 12%;
            left: 12%;
            width: 30%;
            height: 15%;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 50%;
            transform: rotate(-35deg);
            pointer-events: none;
            transition: all 0.3s ease-out;
            filter: blur(2px);
        }
        .panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 30px 30px 0 0;
            box-shadow: 0 -15px 40px rgba(0,0,0,0.15);
            padding: 20px;
            z-index: 200;
        }
        .ingredient-btn {
            background: white;
            border: 2px solid #ffb6c1;
            border-radius: 15px;
            padding: 10px;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 65px;
        }
        .ingredient-btn:active { transform: scale(0.9); background: #fff5f8; }

        #growth-bar-container {
            width: 80%;
            height: 15px;
            background: #ffe4e1;
            border-radius: 10px;
            margin: 10px auto;
            overflow: hidden;
            border: 2px solid #ffb6c1;
        }
        #growth-bar-inner {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, #ff69b4, #ffb6c1);
            transition: width 0.3s ease-out;
        }

        #msg {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 105, 180, 0.9);
            color: white;
            padding: 12px 25px;
            border-radius: 30px;
            font-weight: bold;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 300;
        }

        .food-item, .tool-item, .bubble-item {
            position: absolute;
            font-size: 50px;
            pointer-events: none;
            z-index: 200;
        }
        .food-anim { animation: fall-to-mouth 1s cubic-bezier(0.5, 0, 0.5, 1) forwards; }
        @keyframes fall-to-mouth {
            0% { transform: translateY(-100px) scale(1); opacity: 1; }
            100% { transform: translateY(0) scale(0); opacity: 0; }
        }

        @keyframes float-bubble {
            0% { transform: translate(0, 0); opacity: 1; }
            100% { transform: translate(var(--tx), -200px); opacity: 0; }
        }

        .location-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 5px 15px;
            background: white;
            border-radius: 20px;
            font-weight: bold;
            color: #ff69b4;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            z-index: 100;
        }

        .dark-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 30, 0.7);
            pointer-events: none;
            display: none;
            z-index: 150;
        }

        .nav-btn {
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 12px;
            transition: all 0.2s;
            white-space: nowrap;
        }
        .nav-active { background: #ff69b4; color: white; box-shadow: 0 4px 10px rgba(255, 105, 180, 0.4); }
        .nav-inactive { background: #fdf2f8; color: #ff69b4; }

        .kok-effect {
            position: absolute;
            font-weight: bold;
            color: #ff1493;
            pointer-events: none;
            z-index: 210;
            animation: kok-up 0.8s ease-out forwards;
        }
        @keyframes kok-up {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-50px) scale(1.5); opacity: 0; }
        }

        .glitter {
            position: absolute;
            width: 5px;
            height: 5px;
            background: white;
            border-radius: 50%;
            pointer-events: none;
            animation: sparkle 1.5s infinite;
        }
        @keyframes sparkle {
            0%, 100% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1); opacity: 1; }
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>

<div id="game-screen">
    <div id="dark-mode" class="dark-overlay"></div>
    <div id="msg">ë©”ì‹œì§€</div>
    <div id="location-name" class="location-badge">ê±°ì‹¤ ğŸ </div>

    <div class="p-4 text-center">
        <h1 class="text-3xl font-extrabold text-pink-500 mb-1 drop-shadow-sm">ğŸ§ª ì²´ì´ì˜ ìŠ¬ë¼ì„ í‚¤ìš°ê¸° ğŸ§ª</h1>
        <div class="text-sm font-bold text-pink-400">ë ˆë²¨: <span id="level-txt">1</span> | ì¥ì†Œë¥¼ ì´ë™í•´ì„œ ë†€ì•„ì£¼ì„¸ìš”!</div>
        <div id="growth-bar-container">
            <div id="growth-bar-inner"></div>
        </div>
    </div>

    <div id="slime-container">
        <div id="playground-elements" class="absolute w-full h-full flex justify-center items-center pointer-events-none"></div>

        <div id="slime" class="slime" style="display:none;"
             onmousedown="handlePoke(event)"
             ontouchstart="handlePoke(event)">
            <div id="glitter-container" class="absolute inset-0 overflow-hidden rounded-full pointer-events-none"></div>
            <div id="hi-light" class="highlight"></div>
            <div class="face">
                <div class="eyes" id="slime-eyes">
                    <div class="eye"></div>
                    <div class="eye"></div>
                </div>
                <div class="mouth" id="slime-mouth"></div>
            </div>
        </div>
        <div id="empty-pot" class="w-72 h-72 border-4 border-dashed border-pink-200 rounded-full flex items-center justify-center text-pink-300 font-bold text-center text-xl">
            ë¬¼í’€ì„ ë„£ì–´ì„œ<br>ìŠ¬ë¼ì„ì„ íƒœì–´ë‚˜ê²Œ í•´ì¤˜!
        </div>
    </div>

    <div class="panel">
        <div class="max-w-xl mx-auto">
            <div class="flex gap-1 mb-4 justify-start overflow-x-auto pb-2 no-scrollbar">
                <button onclick="changeLocation('living')" class="nav-btn nav-active" id="btn-living">ê±°ì‹¤ ğŸ </button>
                <button onclick="changeLocation('kitchen')" class="nav-btn nav-inactive" id="btn-kitchen">ì£¼ë°© ğŸ³</button>
                <button onclick="changeLocation('bath')" class="nav-btn nav-inactive" id="btn-bath">ìš•ì‹¤ ğŸ›</button>
                <button onclick="changeLocation('hospital')" class="nav-btn nav-inactive" id="btn-hospital">ë³‘ì› ğŸ¥</button>
                <button onclick="changeLocation('play')" class="nav-btn nav-inactive" id="btn-play">ë†€ì´í„° ğŸ¡</button>
                <button onclick="changeLocation('garden')" class="nav-btn nav-inactive" id="btn-garden">ì •ì› ğŸŒ³</button>
                <button onclick="changeLocation('bed')" class="nav-btn nav-inactive" id="btn-bed">ì¹¨ì‹¤ ğŸ˜´</button>
            </div>

            <!-- ê±°ì‹¤ ë„êµ¬ -->
            <div id="items-living" class="flex justify-start mb-4 bg-pink-50 p-4 rounded-2xl gap-2 overflow-x-auto no-scrollbar">
                <button onclick="addIngredient('glue')" class="ingredient-btn shadow-sm">
                    <span class="text-3xl">ğŸ§´</span>
                    <span class="text-[10px] font-bold mt-1">ë¬¼í’€</span>
                </button>
                <button onclick="addIngredient('glitter')" class="ingredient-btn shadow-sm bg-purple-50 border-purple-200">
                    <span class="text-3xl">âœ¨</span>
                    <span class="text-[10px] font-bold mt-1">ê¸€ë¦¬í„°</span>
                </button>
                <button onclick="addIngredient('foam')" class="ingredient-btn shadow-sm bg-blue-50 border-blue-200">
                    <span class="text-3xl">â˜ï¸</span>
                    <span class="text-[10px] font-bold mt-1">í¼</span>
                </button>
                <button onclick="giveFood('ğŸ¬')" class="ingredient-btn shadow-sm bg-yellow-50 border-yellow-200">
                    <span class="text-3xl">ğŸ¬</span>
                    <span class="text-[10px] font-bold mt-1">ì‚¬íƒ•</span>
                </button>
            </div>

            <!-- ì£¼ë°© ë„êµ¬ -->
            <div id="items-kitchen" class="hidden flex justify-center mb-4 bg-orange-50 p-4 rounded-2xl gap-2 overflow-x-auto no-scrollbar">
                <button onclick="cookFood('ğŸ³')" class="ingredient-btn shadow-sm bg-orange-100 border-orange-300">
                    <span class="text-3xl">ğŸ³</span>
                    <span class="text-[10px] font-bold mt-1">í›„ë¼ì´</span>
                </button>
                <button onclick="cookFood('ğŸ•')" class="ingredient-btn shadow-sm bg-red-100 border-red-300">
                    <span class="text-3xl">ğŸ•</span>
                    <span class="text-[10px] font-bold mt-1">í”¼ì</span>
                </button>
                <button onclick="cookFood('ğŸ¥')" class="ingredient-btn shadow-sm bg-yellow-100 border-yellow-300">
                    <span class="text-3xl">ğŸ¥</span>
                    <span class="text-[10px] font-bold mt-1">íŒ¬ì¼€ì´í¬</span>
                </button>
            </div>

            <!-- ìš•ì‹¤ ë„êµ¬ -->
            <div id="items-bath" class="hidden flex justify-center mb-4 bg-blue-50 p-4 rounded-2xl gap-2 overflow-x-auto no-scrollbar">
                <button onclick="washSlime('ğŸ§¼')" class="ingredient-btn shadow-sm bg-white border-blue-200">
                    <span class="text-3xl">ğŸ§¼</span>
                    <span class="text-[10px] font-bold mt-1">ë¹„ëˆ„</span>
                </button>
                <button onclick="washSlime('ğŸ›')" class="ingredient-btn shadow-sm bg-white border-blue-200">
                    <span class="text-3xl">ğŸ›</span>
                    <span class="text-[10px] font-bold mt-1">ê±°í’ˆ</span>
                </button>
                <button onclick="washSlime('ğŸš¿')" class="ingredient-btn shadow-sm bg-white border-blue-200">
                    <span class="text-3xl">ğŸš¿</span>
                    <span class="text-[10px] font-bold mt-1">ìƒ¤ì›Œ</span>
                </button>
            </div>

            <!-- ë³‘ì› ë„êµ¬ -->
            <div id="items-hospital" class="hidden flex justify-center mb-4 bg-red-50 p-4 rounded-2xl gap-2 overflow-x-auto no-scrollbar">
                <button onclick="treatSlime('ğŸ’‰')" class="ingredient-btn shadow-sm bg-white border-red-300">
                    <span class="text-3xl">ğŸ’‰</span>
                    <span class="text-[10px] font-bold mt-1">ì£¼ì‚¬</span>
                </button>
                <button onclick="treatSlime('ğŸ’Š')" class="ingredient-btn shadow-sm bg-white border-blue-300">
                    <span class="text-3xl">ğŸ’Š</span>
                    <span class="text-[10px] font-bold mt-1">ê°€ë£¨ì•½</span>
                </button>
                <button onclick="treatSlime('ğŸ©¹')" class="ingredient-btn shadow-sm bg-white border-yellow-300">
                    <span class="text-3xl">ğŸ©¹</span>
                    <span class="text-[10px] font-bold mt-1">ë°´ë“œ</span>
                </button>
            </div>

            <!-- ë†€ì´í„° ë„êµ¬ -->
            <div id="items-play" class="hidden flex justify-center mb-4 bg-green-50 p-4 rounded-2xl gap-2 overflow-x-auto no-scrollbar">
                <button onclick="playRide('slide')" class="ingredient-btn shadow-sm bg-red-100 border-red-300">
                    <span class="text-3xl">ğŸ›</span>
                    <span class="text-[10px] font-bold mt-1">ë¯¸ë„ëŸ¼í‹€</span>
                </button>
                <button onclick="playRide('seesaw')" class="ingredient-btn shadow-sm bg-yellow-100 border-yellow-300">
                    <span class="text-3xl">âš–ï¸</span>
                    <span class="text-[10px] font-bold mt-1">ì‹œì†Œ</span>
                </button>
                <button onclick="playRide('swing')" class="ingredient-btn shadow-sm bg-blue-100 border-blue-300">
                    <span class="text-3xl">ğŸ¡</span>
                    <span class="text-[10px] font-bold mt-1">ê·¸ë„¤</span>
                </button>
            </div>

            <!-- ì •ì› ë„êµ¬ -->
            <div id="items-garden" class="hidden flex justify-center mb-4 bg-emerald-50 p-4 rounded-2xl gap-2 overflow-x-auto no-scrollbar">
                <button onclick="gardenAction('ğŸ¦‹')" class="ingredient-btn shadow-sm bg-white border-emerald-300">
                    <span class="text-3xl">ğŸ¦‹</span>
                    <span class="text-[10px] font-bold mt-1">ë‚˜ë¹„ê´€ì°°</span>
                </button>
                <button onclick="gardenAction('ğŸŒ¸')" class="ingredient-btn shadow-sm bg-white border-emerald-300">
                    <span class="text-3xl">ğŸŒ¸</span>
                    <span class="text-[10px] font-bold mt-1">ê½ƒì‹¬ê¸°</span>
                </button>
                <button onclick="gardenAction('âš½')" class="ingredient-btn shadow-sm bg-white border-emerald-300">
                    <span class="text-3xl">âš½</span>
                    <span class="text-[10px] font-bold mt-1">ê³µë†€ì´</span>
                </button>
            </div>

            <!-- ì¹¨ì‹¤ ë„êµ¬ -->
            <div id="items-bed" class="hidden flex justify-center mb-4 bg-purple-50 p-4 rounded-2xl gap-4">
                <button onclick="toggleSleep()" class="ingredient-btn shadow-sm bg-indigo-100 border-indigo-300">
                    <span class="text-3xl" id="sleep-icon">ğŸŒ™</span>
                    <span class="text-[10px] font-bold mt-1" id="sleep-text">ì¬ìš°ê¸°</span>
                </button>
            </div>

            <!-- ìƒ‰ìƒ ë³€ê²½ -->
            <div class="flex justify-center gap-4 flex-wrap mt-2">
                <div class="flex gap-2 items-center">
                    <div class="w-8 h-8 rounded-full cursor-pointer border-2 border-white shadow-sm" style="background:#ffb6c1" onclick="updateColor('#ffb6c1')"></div>
                    <div class="w-8 h-8 rounded-full cursor-pointer border-2 border-white shadow-sm" style="background:#add8e6" onclick="updateColor('#add8e6')"></div>
                    <div class="w-8 h-8 rounded-full cursor-pointer border-2 border-white shadow-sm" style="background:#b0fb97" onclick="updateColor('#b0fb97')"></div>
                    <div class="w-8 h-8 rounded-full cursor-pointer border-2 border-white shadow-sm" style="background:#ffd966" onclick="updateColor('#ffd966')"></div>
                    <div class="w-8 h-8 rounded-full cursor-pointer border-2 border-white shadow-sm" style="background:#d8b4fe" onclick="updateColor('#d8b4fe')"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const slime = document.getElementById('slime');
    const emptyPot = document.getElementById('empty-pot');
    const msgBox = document.getElementById('msg');
    const growthBar = document.getElementById('growth-bar-inner');
    const levelTxt = document.getElementById('level-txt');
    const slimeMouth = document.getElementById('slime-mouth');
    const locName = document.getElementById('location-name');
    const pgElements = document.getElementById('playground-elements');
    const darkOverlay = document.getElementById('dark-mode');
    const glitterContainer = document.getElementById('glitter-container');

    let stats = { glue: 0, glitter: 0, foam: 0 };
    let experience = 0;
    let level = 1;
    let totalEaten = 0;
    let baseColor = '#ffb6c1';
    let isSleeping = false;
    let isSick = false;
    let currentLocation = 'living';

    function showMsg(text) {
        msgBox.innerText = text;
        msgBox.style.opacity = 1;
        setTimeout(() => msgBox.style.opacity = 0, 1500);
    }

    function handlePoke(e) {
        if (isSleeping) return showMsg("ìŠ¬ë¼ì„ì´ ìê³  ìˆì–´... ğŸ’¤");

        e.preventDefault();
        const rect = slime.getBoundingClientRect();
        const clientX = e.clientX || (e.touches ? e.touches[0].clientX : 0);
        const clientY = e.clientY || (e.touches ? e.touches[0].clientY : 0);

        const relX = (clientX - (rect.left + rect.width / 2)) / (rect.width / 2);
        const relY = (clientY - (rect.top + rect.height / 2)) / (rect.height / 2);

        let tl = 50, tr = 50, bl = 50, br = 50;
        if (relX < 0 && relY < 0) tl = 20;
        if (relX > 0 && relY < 0) tr = 20;
        if (relX < 0 && relY > 0) bl = 20;
        if (relX > 0 && relY > 0) br = 20;

        slime.style.borderRadius = `${tl}% ${tr}% ${br}% ${bl}%`;
        slime.style.transform = `scale(0.95) translate(${relX * 10}px, ${relY * 10}px)`;

        const kok = document.createElement('div');
        kok.className = 'kok-effect';
        const sounds = ['ì½•!', 'ì«€ë“!', 'ë§ë‘!', 'í­ì‹ !', 'ì¹˜ë•!'];
        kok.innerText = sounds[Math.floor(Math.random() * sounds.length)];
        kok.style.left = (clientX - 20) + 'px';
        kok.style.top = (clientY - 20) + 'px';
        document.body.appendChild(kok);
        setTimeout(() => kok.remove(), 800);

        if(!isSick) slimeMouth.className = 'mouth happy';
        gainExp(5);

        setTimeout(() => {
            if (!isSleeping) {
                slime.style.borderRadius = '50%';
                slime.style.transform = '';
                if(!isSick) slimeMouth.className = 'mouth';
            }
        }, 300);

        // í™•ë¥ ì ìœ¼ë¡œ ë°°íƒˆ ë‚˜ê¸°
        if (totalEaten > 5 && Math.random() < 0.05) {
            makeSick();
        }
    }

    function makeSick() {
        if (isSick) return;
        isSick = true;
        slimeMouth.className = 'mouth sick';
        showMsg("ì•„êµ¬êµ¬... ìŠ¬ë¼ì„ ë°°ê°€ ì•„í”ˆê°€ë´ìš”! ğŸ¥");
    }

    function changeLocation(loc) {
        currentLocation = loc;
        const sections = ['living', 'kitchen', 'bath', 'hospital', 'play', 'garden', 'bed'];
        sections.forEach(s => {
            document.getElementById(`items-${s}`).classList.add('hidden');
            document.getElementById(`btn-${s}`).className = "nav-btn nav-inactive";
        });
        document.getElementById(`items-${loc}`).classList.remove('hidden');
        document.getElementById(`btn-${loc}`).className = "nav-btn nav-active";

        pgElements.innerHTML = '';
        stopRide();

        const locData = {
            living: { color: '#fff0f5', name: "ê±°ì‹¤ ğŸ " },
            kitchen: { color: '#fff7ed', name: "ì£¼ë°© ğŸ³" },
            bath: { color: '#e0f2fe', name: "ìš•ì‹¤ ğŸ›" },
            hospital: { color: '#f8fafc', name: "ë³‘ì› ğŸ¥" },
            play: { color: '#f0fff4', name: "ë†€ì´í„° ğŸ¡" },
            garden: { color: '#ecfdf5', name: "ì •ì› ğŸŒ³" },
            bed: { color: '#f5f3ff', name: "ì¹¨ì‹¤ ğŸ˜´" }
        };
        document.body.style.backgroundColor = locData[loc].color;
        locName.innerText = locData[loc].name;

        if (loc === 'kitchen') {
            const obj = document.createElement('div');
            obj.className = 'kitchen-obj';
            obj.innerText = 'ğŸ¥˜';
            pgElements.appendChild(obj);
        } else if (loc === 'hospital') {
            const obj = document.createElement('div');
            obj.className = 'hospital-obj';
            obj.innerText = 'â•';
            pgElements.appendChild(obj);
        } else if (loc === 'bath') {
            const obj = document.createElement('div');
            obj.className = 'bath-obj';
            obj.innerText = 'ğŸ›';
            pgElements.appendChild(obj);
        } else if (loc === 'garden') {
            const obj = document.createElement('div');
            obj.className = 'garden-obj';
            obj.innerText = 'ğŸŒ³';
            pgElements.appendChild(obj);
        }
    }

    function washSlime(tool) {
        if (stats.glue === 0) return showMsg("ìŠ¬ë¼ì„ì„ ë¨¼ì € ë§Œë“¤ì–´ì¤˜!");
        showMsg(`${tool} ë¡œ ê¹¨ë—í•˜ê²Œ ì”»ëŠ” ì¤‘! âœ¨`);
        slime.classList.add('wash-anim');

        for (let i = 0; i < 10; i++) {
            setTimeout(() => {
                const b = document.createElement('div');
                b.className = 'bubble-item';
                b.innerText = 'ğŸ«§';
                const rect = slime.getBoundingClientRect();
                b.style.left = (rect.left + Math.random() * rect.width) + 'px';
                b.style.top = (rect.top + rect.height / 2) + 'px';
                b.style.setProperty('--tx', (Math.random() * 100 - 50) + 'px');
                b.style.animation = 'float-bubble 1s ease-out forwards';
                document.body.appendChild(b);
                setTimeout(() => b.remove(), 1000);
            }, i * 100);
        }

        setTimeout(() => {
            slime.classList.remove('wash-anim');
            gainExp(30);
            showMsg("ë°˜ì§ë°˜ì§ ê¹¨ë—í•´ì¡Œì–´! ğŸ«§");
        }, 1500);
    }

    function gardenAction(emoji) {
        if (stats.glue === 0) return showMsg("ìŠ¬ë¼ì„ì„ ë¨¼ì € ë§Œë“¤ì–´ì¤˜!");
        showMsg(`${emoji} ì¦ê±°ìš´ ì‹œê°„!`);
        gainExp(40);
        const effect = document.createElement('div');
        effect.className = 'tool-item';
        effect.innerText = emoji;
        effect.style.left = '50%';
        effect.style.top = '40%';
        effect.style.animation = 'kok-up 1.5s ease-out forwards';
        document.body.appendChild(effect);
        setTimeout(() => effect.remove(), 1500);
    }

    function addIngredient(type) {
        if (type === 'glue') stats.glue++;
        if (type === 'glitter') stats.glitter++;
        if (type === 'foam') stats.foam++;
        gainExp(20);
        calculateSlime();
        showMsg(`${type === 'glue' ? 'ë¬¼í’€' : type === 'glitter' ? 'ë°˜ì§ì´' : 'í¼'} ì¶”ê°€! âœ¨`);
    }

    function cookFood(emoji) {
        if (stats.glue === 0) return showMsg("ìŠ¬ë¼ì„ì„ ë¨¼ì € ë§Œë“¤ì–´ì¤˜!");
        showMsg("ë³´ê¸€ë³´ê¸€... ìš”ë¦¬ ì¤‘! ğŸ³");
        setTimeout(() => giveFood(emoji), 1000);
    }

    function giveFood(emoji) {
        if (stats.glue === 0) return showMsg("ìŠ¬ë¼ì„ì„ ë¨¼ì € ë§Œë“¤ì–´ì¤˜!");
        if (isSleeping) return showMsg("ìê³  ìˆì„ ë• ëª» ë¨¹ì–´!");

        slimeMouth.className = 'mouth eating';
        const food = document.createElement('div');
        food.className = 'food-item food-anim';
        food.innerText = emoji;
        food.style.left = '50%';
        food.style.top = '40%';
        document.getElementById('slime-container').appendChild(food);

        setTimeout(() => {
            food.remove();
            totalEaten++;
            gainExp(40);
            showMsg(`${emoji} ëƒ ëƒ ! ë§›ìˆë‹¤! ğŸ˜‹`);
            slime.style.transform = `scale(1.2)`;
            setTimeout(() => {
                slime.style.transform = "";
                slimeMouth.className = isSick ? 'mouth sick' : 'mouth';
            }, 200);
        }, 800);
    }

    function treatSlime(tool) {
        if (stats.glue === 0) return showMsg("ìŠ¬ë¼ì„ì„ ë¨¼ì € ë§Œë“¤ì–´ì¤˜!");
        showMsg(`${tool} ì¹˜ë£Œ ì¤‘... ğŸ¥`);
        gainExp(50);
        if (isSick && (tool === 'ğŸ’‰' || tool === 'ğŸ’Š')) {
            isSick = false;
            setTimeout(() => {
                slimeMouth.className = 'mouth happy';
                showMsg("ë‹¤ ë‚˜ì•˜ì–´! ê³ ë§ˆì›Œ! âœ¨");
                setTimeout(() => slimeMouth.className = 'mouth', 1500);
            }, 1000);
        }
    }

    function playRide(ride) {
        if (stats.glue === 0) return showMsg("ìŠ¬ë¼ì„ì„ ë¨¼ì € ë§Œë“¤ì–´ì¤˜!");
        if (isSick) return showMsg("ì•„íŒŒì„œ ë†€ ìˆ˜ê°€ ì—†ì–´ìš”... ğŸ¥");
        stopRide();
        pgElements.innerHTML = '';
        const obj = document.createElement('div');
        obj.className = `playground-obj ${ride}-obj`;
        const rideData = {
            slide: { icon: 'ğŸ›', anim: 'slide-anim', msg: "ìŠ~~ ë¯¸ë„ëŸ¼í‹€! ğŸ›" },
            seesaw: { icon: 'âš–ï¸', anim: 'seesaw-anim', msg: "ê¸°ìš°ëš±~ ì‹œì†Œ! âš–ï¸" },
            swing: { icon: 'ğŸ¡', anim: 'swing-anim', msg: "ì™”ë‹¤ê°”ë‹¤ ê·¸ë„¤! ğŸ¡" }
        };
        obj.innerText = rideData[ride].icon;
        slime.classList.add(rideData[ride].anim);
        showMsg(rideData[ride].msg);
        pgElements.appendChild(obj);
        gainExp(60);
    }

    function stopRide() {
        slime.classList.remove('slide-anim', 'seesaw-anim', 'swing-anim', 'wash-anim');
    }

    function toggleSleep() {
        if (stats.glue === 0) return showMsg("ìŠ¬ë¼ì„ì„ ë¨¼ì € ë§Œë“¤ì–´ì¤˜!");
        isSleeping = !isSleeping;
        const icon = document.getElementById('sleep-icon');
        const text = document.getElementById('sleep-text');
        if (isSleeping) {
            darkOverlay.style.display = 'block';
            slimeMouth.className = 'mouth sleeping';
            icon.innerText = 'â˜€ï¸';
            text.innerText = 'ê¹¨ìš°ê¸°';
            showMsg("ì½”~ ì˜ ììš”... ğŸ’¤");
        } else {
            darkOverlay.style.display = 'none';
            slimeMouth.className = isSick ? 'mouth sick' : 'mouth';
            icon.innerText = 'ğŸŒ™';
            text.innerText = 'ì¬ìš°ê¸°';
            showMsg("ë²ˆì©! ì¼ì–´ë‚¬ë‹¤! âœ¨");
        }
    }

    function gainExp(amount) {
        experience += amount;
        let nextLevelExp = level * 100;
        if (experience >= nextLevelExp) { experience -= nextLevelExp; level++; showMsg(`Lv.${level}ë¡œ ì‘¥ì‘¥ ì„±ì¥! ğŸ‰`); }
        levelTxt.innerText = level;
        growthBar.style.width = (experience / nextLevelExp) * 100 + "%";
    }

    function calculateSlime() {
        if (stats.glue === 0) {
            slime.style.display = 'none';
            emptyPot.style.display = 'flex';
            return;
        }
        slime.style.display = 'flex';
        emptyPot.style.display = 'none';
        let baseSize = window.innerWidth < 600 ? 180 : 250;
        let finalSize = Math.min(baseSize + (level * 10) + (stats.glue * 5), window.innerHeight * 0.5);
        slime.style.width = finalSize + 'px';
        slime.style.height = finalSize + 'px';
        slime.style.filter = `blur(${Math.max(1, 8 - stats.foam)}px)`;
        glitterContainer.innerHTML = '';
        for (let i = 0; i < stats.glitter * 5; i++) {
            const g = document.createElement('div');
            g.className = 'glitter';
            g.style.left = Math.random() * 100 + '%';
            g.style.top = Math.random() * 100 + '%';
            g.style.animationDelay = Math.random() * 2 + 's';
            glitterContainer.appendChild(g);
        }
        const colorWithAlpha = `${baseColor}${Math.floor(0.85*255).toString(16).padStart(2,'0')}`;
        slime.style.background = `radial-gradient(circle at 35% 35%, rgba(255, 255, 255, 0.9) 0%, ${colorWithAlpha} 55%, ${baseColor} 100%)`;
    }

    function updateColor(color) { baseColor = color; calculateSlime(); }

    window.addEventListener('mousemove', (e) => {
        if (stats.glue === 0 || isSleeping) return;
        document.querySelectorAll('.eye').forEach(eye => {
            const rect = eye.getBoundingClientRect();
            const angle = Math.atan2(e.clientY - (rect.top + 17), e.clientX - (rect.left + 12));
            eye.style.transform = `translate(${Math.cos(angle) * 4}px, ${Math.sin(angle) * 4}px)`;
        });
    });
</script>

</body>
</html>
